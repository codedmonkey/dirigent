<script>
  {
    const usernameFieldRow = document.querySelector('[data-credentials-field="username"]');
    const passwordFieldRow = document.querySelector('[data-credentials-field="password"]');
    const tokenFieldRow = document.querySelector('[data-credentials-field="token"]');

    const initalType = document.querySelector('[name="Credentials[type]"]:checked')?.value ?? null;
    if (initalType) {
      updateCredentialsFields(initalType);
    }

    document.querySelectorAll('[name="Credentials[type]"]').forEach(input => {
      input.addEventListener('change', () => {
        updateCredentialsFields(input.value);
      });
    });

    function updateCredentialsFields(type) {
      if (type === 'http-basic') {
        usernameFieldRow.style.display = null;
        passwordFieldRow.style.display = null;
        tokenFieldRow.style.display = 'none';
      } else if (type === 'github-oauth') {
        usernameFieldRow.style.display = 'none';
        passwordFieldRow.style.display = 'none';
        tokenFieldRow.style.display = null;
      } else if (type === 'gitlab-dt') {
        usernameFieldRow.style.display = null;
        passwordFieldRow.style.display = 'none';
        tokenFieldRow.style.display = null;
      } else if (type === 'gitlab-pat') {
        usernameFieldRow.style.display = 'none';
        passwordFieldRow.style.display = 'none';
        tokenFieldRow.style.display = null;
      } else {
        usernameFieldRow.style.display = null;
        passwordFieldRow.style.display = null;
        tokenFieldRow.style.display = null;
      }
    }
  }
</script>
